{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Disease</th>\n",
       "      <th>Diet</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Fungal infection</td>\n",
       "      <td>Antifungal Diet, Probiotics, Garlic, Coconut o...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Allergy</td>\n",
       "      <td>Elimination Diet, Omega-3-rich foods, Vitamin ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GERD</td>\n",
       "      <td>Low-Acid Diet, Fiber-rich foods, Ginger, Licor...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Chronic cholestasis</td>\n",
       "      <td>Low-Fat Diet, High-Fiber Diet, Lean proteins, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Drug Reaction</td>\n",
       "      <td>Antihistamine Diet, Omega-3-rich foods, Vitami...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               Disease                                               Diet\n",
       "0     Fungal infection  Antifungal Diet, Probiotics, Garlic, Coconut o...\n",
       "1              Allergy  Elimination Diet, Omega-3-rich foods, Vitamin ...\n",
       "2                 GERD  Low-Acid Diet, Fiber-rich foods, Ginger, Licor...\n",
       "3  Chronic cholestasis  Low-Fat Diet, High-Fiber Diet, Lean proteins, ...\n",
       "4        Drug Reaction  Antihistamine Diet, Omega-3-rich foods, Vitami..."
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# Load the CSV file\n",
    "file_path = \"dataset/diets.csv\"\n",
    "df = pd.read_csv(file_path)\n",
    "\n",
    "# Display the first few rows to understand its structure\n",
    "df.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Disease</th>\n",
       "      <th>Diet_1</th>\n",
       "      <th>Diet_2</th>\n",
       "      <th>Diet_3</th>\n",
       "      <th>Diet_4</th>\n",
       "      <th>Diet_5</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Fungal infection</td>\n",
       "      <td>Antifungal Diet</td>\n",
       "      <td>Probiotics</td>\n",
       "      <td>Garlic</td>\n",
       "      <td>Coconut oil</td>\n",
       "      <td>Turmeric</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Allergy</td>\n",
       "      <td>Elimination Diet</td>\n",
       "      <td>Omega-3-rich foods</td>\n",
       "      <td>Vitamin C-rich foods</td>\n",
       "      <td>Quercetin-rich foods</td>\n",
       "      <td>Probiotics</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GERD</td>\n",
       "      <td>Low-Acid Diet</td>\n",
       "      <td>Fiber-rich foods</td>\n",
       "      <td>Ginger</td>\n",
       "      <td>Licorice</td>\n",
       "      <td>Aloe vera juice</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Chronic cholestasis</td>\n",
       "      <td>Low-Fat Diet</td>\n",
       "      <td>High-Fiber Diet</td>\n",
       "      <td>Lean proteins</td>\n",
       "      <td>Whole grains</td>\n",
       "      <td>Fresh fruits and vegetables</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Drug Reaction</td>\n",
       "      <td>Antihistamine Diet</td>\n",
       "      <td>Omega-3-rich foods</td>\n",
       "      <td>Vitamin C-rich foods</td>\n",
       "      <td>Quercetin-rich foods</td>\n",
       "      <td>Probiotics</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               Disease              Diet_1              Diet_2  \\\n",
       "0     Fungal infection     Antifungal Diet          Probiotics   \n",
       "1              Allergy    Elimination Diet  Omega-3-rich foods   \n",
       "2                 GERD       Low-Acid Diet    Fiber-rich foods   \n",
       "3  Chronic cholestasis        Low-Fat Diet     High-Fiber Diet   \n",
       "4        Drug Reaction  Antihistamine Diet  Omega-3-rich foods   \n",
       "\n",
       "                 Diet_3                Diet_4                       Diet_5  \n",
       "0                Garlic           Coconut oil                     Turmeric  \n",
       "1  Vitamin C-rich foods  Quercetin-rich foods                   Probiotics  \n",
       "2                Ginger              Licorice              Aloe vera juice  \n",
       "3         Lean proteins          Whole grains  Fresh fruits and vegetables  \n",
       "4  Vitamin C-rich foods  Quercetin-rich foods                   Probiotics  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Split the Diet column into multiple columns\n",
    "diet_split = df[\"Diet\"].str.split(\", \", expand=True)\n",
    "\n",
    "# Rename the new columns\n",
    "diet_split.columns = [f\"Diet_{i+1}\" for i in range(diet_split.shape[1])]\n",
    "\n",
    "# Combine with the original Disease column\n",
    "df_expanded = pd.concat([df[\"Disease\"], diet_split], axis=1)\n",
    "\n",
    "# Display the first few rows of the modified dataframe\n",
    "df_expanded.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'dataset/diets_expanded.csv'"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Define the export file path\n",
    "export_path = \"dataset/diets_expanded.csv\"\n",
    "\n",
    "# Save the modified DataFrame to CSV\n",
    "df_expanded.to_csv(export_path, index=False)\n",
    "\n",
    "# Provide the download link\n",
    "export_path\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Disease</th>\n",
       "      <th>Medication</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Fungal infection</td>\n",
       "      <td>Antifungal Cream, Fluconazole, Terbinafine, Cl...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Allergy</td>\n",
       "      <td>Antihistamines, Decongestants, Epinephrine, Co...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GERD</td>\n",
       "      <td>Proton Pump Inhibitors (PPIs), H2 Blockers, An...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Chronic cholestasis</td>\n",
       "      <td>Ursodeoxycholic acid, Cholestyramine, Methotre...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Drug Reaction</td>\n",
       "      <td>Antihistamines, Epinephrine, Corticosteroids, ...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               Disease                                         Medication\n",
       "0     Fungal infection  Antifungal Cream, Fluconazole, Terbinafine, Cl...\n",
       "1              Allergy  Antihistamines, Decongestants, Epinephrine, Co...\n",
       "2                 GERD  Proton Pump Inhibitors (PPIs), H2 Blockers, An...\n",
       "3  Chronic cholestasis  Ursodeoxycholic acid, Cholestyramine, Methotre...\n",
       "4        Drug Reaction  Antihistamines, Epinephrine, Corticosteroids, ..."
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "\n",
    "# Load the CSV file\n",
    "file_path = \"dataset/medications.csv\"\n",
    "df = pd.read_csv(file_path)\n",
    "\n",
    "# Display the first few rows to understand its structure\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Disease</th>\n",
       "      <th>Medication_1</th>\n",
       "      <th>Medication_2</th>\n",
       "      <th>Medication_3</th>\n",
       "      <th>Medication_4</th>\n",
       "      <th>Medication_5</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Fungal infection</td>\n",
       "      <td>Antifungal Cream</td>\n",
       "      <td>Fluconazole</td>\n",
       "      <td>Terbinafine</td>\n",
       "      <td>Clotrimazole</td>\n",
       "      <td>Ketoconazole</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Allergy</td>\n",
       "      <td>Antihistamines</td>\n",
       "      <td>Decongestants</td>\n",
       "      <td>Epinephrine</td>\n",
       "      <td>Corticosteroids</td>\n",
       "      <td>Immunotherapy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GERD</td>\n",
       "      <td>Proton Pump Inhibitors (PPIs)</td>\n",
       "      <td>H2 Blockers</td>\n",
       "      <td>Antacids</td>\n",
       "      <td>Prokinetics</td>\n",
       "      <td>Antibiotics</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Chronic cholestasis</td>\n",
       "      <td>Ursodeoxycholic acid</td>\n",
       "      <td>Cholestyramine</td>\n",
       "      <td>Methotrexate</td>\n",
       "      <td>Corticosteroids</td>\n",
       "      <td>Liver transplant</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Drug Reaction</td>\n",
       "      <td>Antihistamines</td>\n",
       "      <td>Epinephrine</td>\n",
       "      <td>Corticosteroids</td>\n",
       "      <td>Antibiotics</td>\n",
       "      <td>Antifungal Cream</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               Disease                   Medication_1    Medication_2  \\\n",
       "0     Fungal infection               Antifungal Cream     Fluconazole   \n",
       "1              Allergy                 Antihistamines   Decongestants   \n",
       "2                 GERD  Proton Pump Inhibitors (PPIs)     H2 Blockers   \n",
       "3  Chronic cholestasis           Ursodeoxycholic acid  Cholestyramine   \n",
       "4        Drug Reaction                 Antihistamines     Epinephrine   \n",
       "\n",
       "      Medication_3     Medication_4      Medication_5  \n",
       "0      Terbinafine     Clotrimazole      Ketoconazole  \n",
       "1      Epinephrine  Corticosteroids     Immunotherapy  \n",
       "2         Antacids      Prokinetics       Antibiotics  \n",
       "3     Methotrexate  Corticosteroids  Liver transplant  \n",
       "4  Corticosteroids      Antibiotics  Antifungal Cream  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Split the Diet column into multiple columns\n",
    "medication_split = df[\"Medication\"].str.split(\", \", expand=True)\n",
    "\n",
    "# Rename the new columns\n",
    "medication_split.columns = [f\"Medication_{i+1}\" for i in range(medication_split.shape[1])]\n",
    "\n",
    "# Combine with the original Disease column\n",
    "df_expanded = pd.concat([df[\"Disease\"], medication_split], axis=1)\n",
    "\n",
    "# Display the first few rows of the modified dataframe\n",
    "df_expanded.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'dataset/medication_expanded.csv'"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Define the export file path\n",
    "export_path = \"dataset/medication_expanded.csv\"\n",
    "\n",
    "# Save the modified DataFrame to CSV\n",
    "df_expanded.to_csv(export_path, index=False)\n",
    "\n",
    "# Provide the download link\n",
    "export_path"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
